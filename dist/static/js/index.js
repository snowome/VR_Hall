(self.webpackChunkcity=self.webpackChunkcity||[]).push([[826],{291:function(S,F,e){"use strict";var o=e(391),t=e(926),n={mapImage:e(525),redDotImage:e(451),mapDirImage:e(722)},t=(0,o.Z)(t)(n),n=(document.getElementById("map-container").innerHTML=t,e(376)),t={roamImage:e(502)},o=(0,o.Z)(n)(t),l=(document.getElementById("roam-container").innerHTML=o,e(616)),n=e(349),t=new l.Ox3(16777215,.8),o=(t.position.set(200,400,300),new l.cBI(t,5),new l.Ox3(16777215,.8)),u=(o.position.set(-200,400,300),new l.cBI(o,5),new l.Mig(16777215,.8),new l.y8_(3e3),400),y=!0,i=120,m=[],s={camera:null},d=[],c={isRoaming:!1,startDegree:270,endDegree:0,i:0},p=[],g={room0:[{deg:0,toRoom:"room1",mandeg:270,reverse:!1,position:{x:.6015032553134478,y:-43.74372552004664,z:-170}}],room1:[{deg:-180,toRoom:"room0",mandeg:450,reverse:!0,position:{x:-.17486207415977262,y:-91.43211068189166,z:170}},{deg:88,toRoom:"room2",mandeg:180,reverse:!0,position:{x:-170,y:-63.77847120147063,z:.7914023907177943}},{deg:-88,toRoom:"room10",position:{x:170,y:-66.00373404926036,z:4.83201197220105}},{deg:-60,toRoom:"room8",position:{x:169.99999999999997,y:-43.4543143486798,z:-110.80258589869673}}],room2:[{deg:-89,toRoom:"room1",position:{x:170,y:-74.86957851527241,z:-3.880960393804159}},{deg:111,toRoom:"room3",mandeg:160,reverse:!0,position:{x:-170,y:-64.16963772850595,z:3.835985945982242}},{deg:44,toRoom:"room4",position:{x:-155.04201589734612,y:-70.28634594140465,z:-169.99999999999994}}],room3:[{deg:-70,toRoom:"room2",position:{x:169.99999999999994,y:-68.81231864194899,z:-19.44877519347105}},{deg:-10,toRoom:"room4",mandeg:284,reverse:!1,position:{x:58.06451890453953,y:-68.7239666871113,z:-170}}],room4:[{deg:-139,toRoom:"room2",position:{x:144.8800410706267,y:-87.26319877089207,z:170.00000000000009}},{deg:168,toRoom:"room3",position:{x:-41.997849896523974,y:-57.197834220453046,z:170.00000000000006}},{deg:-29,toRoom:"room5",mandeg:303,reverse:!1,position:{x:105.8913055429836,y:-74.77594096537854,z:-170}}],room5:[{deg:146,toRoom:"room4",position:{x:-124.544071897257,y:-67.98846793465967,z:169.99999999999997}},{deg:-111,toRoom:"room6",mandeg:380,reverse:!1,position:{x:170.00000000000003,y:-58.69945079029148,z:68.44694495132948}}],room6:[{deg:68,toRoom:"room5",position:{x:-169.99999999999997,y:-53.48167508723918,z:-64.87764703783185}},{deg:-65,toRoom:"room7",mandeg:339,reverse:!0,position:{x:169.99999999999997,y:-62.43899271986475,z:-70.23225374368569}}],room7:[{deg:110,toRoom:"room6",position:{x:-169.99999999999994,y:-53.078666085491676,z:54.31654111533162}},{deg:-168,toRoom:"room8",mandeg:435,reverse:!1,position:{x:26.06340042170578,y:-70.296955065829,z:170}}],room8:[{deg:13,toRoom:"room7",position:{x:-46.66297191920702,y:-71.8418686897783,z:-170}},{deg:-145,toRoom:"room9",mandeg:415,reverse:!0,position:{x:63.40423178179414,y:-70.42370102385881,z:169.99999999999994}},{deg:-154,toRoom:"room10",position:{x:-131.6964185822796,y:-76.19983571489506,z:169.99999999999997}},{deg:122,toRoom:"room1",position:{x:-170.00000000000009,y:-42.1549629521446,z:104.72907719871849}}],room9:[{deg:35,toRoom:"room8",position:{x:-55.82128868626913,y:-73.37723806587306,z:-170}},{deg:87,toRoom:"room10",mandeg:539,reverse:!1,position:{x:-170,y:-80.14264993539643,z:5.791594926392531}}],room10:[{deg:-90,toRoom:"room9",position:{x:170,y:-68.21903359949313,z:.3157896617820448}},{deg:-23,toRoom:"room8",position:{x:144.94063162935765,y:-75.91358796392386,z:-170}},{deg:87,toRoom:"room1",mandeg:539,reverse:!1,position:{x:-169.99999999999994,y:-69.09872725462222,z:8.766490351817465}}]},r={room5:{mp4:[{url:"video/video.mp4",face:"b",bounds:[{x:-90.80363223609503,y:66.8479001135073,z:-199.99999999999997},{x:93.54143019296282,y:-41.29511918274687,z:-199.99999999999997}]},{url:"video/video.mp4",face:"l",bounds:[{x:-200.00000000000006,y:58.574142251008205,z:115.88021513504155},{x:-200,y:21.208095885343425,z:52.093618655347655}]},{url:"video/video.mp4",face:"f",bounds:[{x:92.77414715713908,y:73.33189320417439,z:200},{x:12.698170803942393,y:25.793385589371212,z:200}]},{url:"video/video.mp4",poster:"./img/poster.png",pauseIcon:"./img/pauseIcon.png",playIcon:"./img/playIcon.png",face:"r",bounds:[{x:199.99999999999994,y:59.017388326554425,z:-98.2591330937993},{x:200,y:21.286399025727565,z:-34.46590463105802}]}]}},v=e(317),f=new l.dpR;function A(n,e){var r=new l.trn(15,20),a=new l.vBJ({map:f.load(v),transparent:!0,opacity:1});g[e].forEach(e=>{var o=e.position,t=new l.Kj0(r,a);t.rotation.x=-Math.PI/2,t.position.set(o.x,o.y,o.z),t.name="guidepost_"+e.toRoom,m.push(t),n.add(t)})}function a(e,o){var t,n,r,a,i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return n=!(t=!0),{s:function(){i=i.call(e)},n:function(){var e=i.next();return t=e.done,e},e:function(e){n=!0,r=e},f:function(){try{t||null==i.return||i.return()}finally{if(n)throw r}}};if(Array.isArray(e)||(i=function(e,o){var t;if(e)return"string"==typeof e?w(e,o):"Map"===(t="Object"===(t=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:t)||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?w(e,o):void 0}(e))||o&&e&&"number"==typeof e.length)return i&&(e=i),a=0,{s:o=function(){},n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function w(e,o){(null==o||o>e.length)&&(o=e.length);for(var t=0,n=new Array(o);t<o;t++)n[t]=e[t];return n}var h="./",x=new l.dpR,I=e(367),z=e(976),R=e(471);function b(e){function o(e,o){if(y){var t=e,n=o,r=1,a=u/5,i=new l.ZAu;i.name="face_"+n;for(var m=-u/2;m<u/2;m+=a){for(var s=1,d=u/2;-u/2<d;d-=a){var c=new l._12(a,a,32,32),p=new l.vBJ({map:x.load(h+`_assets/images/sprite/${t}/${n}/${s}_${r}.jpg`)}),c=new l.Kj0(c,p);c.position.x=m+a/2,c.position.y=d-a/2,c.position.z=0,i.add(c),s++}r++}return i}return e=e,o=o,g=new l.BKK(u,u,32,32),e=new l.vBJ({map:x.load(h+`_assets/images/${e}/${o}.png`)}),new l.Kj0(g,e);var g}var t=[],n=o(e,"f"),n=(n.rotation.y=180*Math.PI/180,n.position.z=u/2,t.push(n),o(e,"b")),n=(n.position.z=-u/2,t.push(n),o(e,"l")),n=(n.rotation.y=-90*Math.PI/180,n.position.x=u/2,t.push(n),o(e,"r")),n=(n.rotation.y=90*Math.PI/180,n.position.x=-u/2,t.push(n),o(e,"u")),n=(n.rotation.x=90*Math.PI/180,n.position.y=u/2,t.push(n),o(e,"d"));return n.rotation.x=-90*Math.PI/180,n.position.y=-u/2,t.push(n),t}function E(o,t,n,r){var a=b(n);console.log(n),function e(){s.camera&&clearTimeout(s.camera);s.camera=setTimeout(()=>{--t.fov,t.updateProjectionMatrix(),75<t.fov?e():(clearTimeout(s.camera),t.fov=i,t.updateProjectionMatrix(),B(o),m.forEach(e=>{o.remove(e)}),m.length=0,d.forEach(e=>{o.remove(e)}),d.length=0,J(o,n),a.forEach(e=>{o.add(e),d.push(e)}),A(o,n),r instanceof Object&&r())},20)}()}function B(e){var o=[],e=(e.traverse(e=>{-1<e.name.indexOf("group_room")&&o.push(e)}),o.forEach(e=>{e.removeFromParent()}),p.length=0,document.getElementsByTagName("video"));if(e.length){var t,n=a(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.pause(),document.documentElement.removeChild(r)}}catch(e){n.e(e)}finally{n.f()}}}function J(d,c){r[c]&&r[c].mp4&&r[c].mp4.forEach((e,o)=>{var t,n,r,a,i=e.bounds,m=(i[0].x+i[1].x)/2,s=(i[0].y+i[1].y)/2,i=i[0].z;"b"===e.face&&(e=e,o=c+"_"+o,(t=new l.ZAu).name="group_"+o,n=e.bounds,r=Math.abs(n[0].x-n[1].x),n=Math.abs(n[0].y-n[1].y),(a=document.createElement("video")).id=o,a.autoplay=!1,a.loop=!0,a.preload="auto",a.innerHTML=`<source src=${h}_assets/${e.url} type="video/mp4">`,document.documentElement.appendChild(a),(e=new l.fO1(a)).minFilter=l.wem,e.magFilter=l.wem,e.format=l.wk1,a=new l.BKK(r,n,32,32),e=new l.vBJ({map:e,color:16777215,depthTest:!1,transparent:!1,side:l.ehD}),a=new l.Kj0(a,e),t.add(a),e=new l.BKK(r,n,32,32),a=new l.vBJ({map:x.load(I)}),(r=new l.Kj0(e,a)).position.z=1,r.name="poster_"+o,t.add(r),n=new l._12(30,30,12,12),e=new l.vBJ({map:x.load(z),transparent:!0,opacity:1}),(a=new l.Kj0(n,e)).position.z=2,a.name="pause_"+o,a.visible=!1,p.push(a),r=new l._12(30,30,12,12),n=new l.vBJ({map:x.load(R),transparent:!0,opacity:1}),(e=new l.Kj0(r,n)).position.z=2,e.name="play_"+o,e.visible=!0,p.push(e),t.add(e),(a=t).position.x=m,a.position.y=s,a.position.z=i,d.add(a))})}var M,D=new l.xsS,t=(M=D,b("room0").forEach(e=>{M.add(e),d.push(e)}),A(D,"room0"),window.innerWidth),o=window.innerHeight,P=new l.cPb(i,t/o,.1,u),L=(P.position.set(0,0,.1),P.lookAt(new l.Pa4(0,0,0)),e(99)),N=e(332);function k(e,o,t,n,r,a){for(var i=5<arguments.length&&void 0!==a?a:1,m=(r<n&&(a=n,n=r,r=a),[]),s=n;s<r;s+=i)m.push({x:Math.cos(s*Math.PI/180)*t+e,y:Math.sin(s*Math.PI/180)*t+o});return m}var j=new l.iMs;function _(e,o,t){c.isRoaming=!1,c.startDegree=270,c.endDegree=0,c.i=0,E(e,o,t),C(t)}function C(e){var o=document.getElementById("map-dir"),e=document.querySelector("."+e);o.style.opacity=0,N.ZP.to("#map-dir",{top:parseFloat(getComputedStyle(e).top)-40+"px",left:parseFloat(getComputedStyle(e).left)-40+"px",duration:2,opacity:1,ease:"elastic"})}function T(e,i,m,s){var o=["room0","room1","room2","room3","room4","room5","room6","room7","room8","room9","room10","room1","room0"],t=(c.isRoaming=!c.isRoaming,document.getElementById("roam-text"));t.innerText=c.isRoaming?"暂停":"漫游",0===c.i&&(s.target=new l.Pa4(0,0,0),m.position.x=0,m.position.y=0,m.position.z=0),function r(){var e=o[c.i];var a=o[c.i+1];c.i+1===o.length&&(c.isRoaming=!1,t.innerText="漫游",c.startDegree=270,c.endDegree=0,c.i=0);g[e].forEach(e=>{var o,t,n;c.isRoaming&&e.toRoom===a&&(c.endDegree=e.mandeg,o=k(0,0,10,c.startDegree,c.endDegree,1),c.startDegree=e.mandeg,e.reverse&&o.reverse(),t=0,n=setInterval(function(){c.isRoaming?t>=o.length-1?(E(i,m,a,function(){C(a),setTimeout(r,1e3)}),c.i++,clearInterval(n)):(s.target=new l.Pa4(o[t].x,.5,o[t].y),t++):clearInterval(n)},30))})}()}var t=window.innerWidth,o=window.innerHeight,O=new l.CP7({}),K=(O.setPixelRatio(window.devicePixelRatio),O.setSize(t,o),new n.z(P,O.domElement));K.enableDamping=!0,K.dampingFactor=.05,K.maxPolarAngle=Math.PI/2,K.minPolarAngle=Math.PI/2,K.maxDistance=200,K.addEventListener("change",function(){}),function e(){O.render(D,P),K.update();var o,t=document.getElementById("map-dir");t&&(o=180*K.getAzimuthalAngle()/Math.PI,t.style.transform=`rotate(${-o}deg)`),requestAnimationFrame(e)}(),window.addEventListener("resize",function(){var e=window.innerWidth,o=window.innerHeight;P.aspect=e/o,P.updateProjectionMatrix(),O.setSize(e,o),O.setPixelRatio(window.devicePixelRatio)}),document.addEventListener("click",e=>{return o=D,t=P,(e=e).preventDefault(),n=e.clientX,e=e.clientY,n=n/window.innerWidth*2-1,e=2*-(e/window.innerHeight)+1,j.setFromCamera(new l.FM8(n,e),t),void((n=j.intersectObjects(m)).length&&_(o,t,n[0].object.name.split("_")[1]));var o,t,n},!1),document.addEventListener("mousemove",e=>{return o=P,(e=e).preventDefault(),n=e.clientX,e=e.clientY,n=n/window.innerWidth*2-1,e=2*-(e/window.innerHeight)+1,j.setFromCamera(new l.FM8(n,e),o),void((n=j.intersectObjects(m)).length?(t=n[0].object,m.find(e=>e.name===t.name).scale.set(2,2,2),document.documentElement.style.cursor="pointer"):(m.forEach(e=>{e.scale.set(1,1,1)}),document.documentElement.style.cursor="auto"));var o,t,n},!1),document.getElementById("map-container").addEventListener("click",function(e){var e=e.target;-1<e.className.indexOf("room")&&(e=e.dataset.name,_(D,P,e))},!1),document.getElementById("roam-container").addEventListener("click",e=>T(0,D,P,K),!1),document.addEventListener("click",e=>{var o,t,n,r,a,i;o=D,t=P,(e=e).preventDefault(),i=e.clientX,e=e.clientY,i=i/window.innerWidth*2-1,e=2*-(e/window.innerHeight)+1,j.setFromCamera(new l.FM8(i,e),t),i=p.filter(e=>!0===e.visible),(e=j.intersectObjects(i)).length&&(i=(t=e[0].object).name.split("_"),i=(e=(0,L.Z)(i,3))[0],n=e[1],r=e[2],e=p.find(e=>e.name===`play_${n}_`+r),a=p.find(e=>e.name===`pause_${n}_`+r),o=o.getObjectByName(`group_${n}_`+r),t.removeFromParent(),(t=o.getObjectByName(`poster_${n}_`+r))&&t.removeFromParent(),t=document.getElementById(n+"_"+r),"play"===i?(e.visible=!1,a.visible=!0,t.play(),o.add(a)):"pause"===i&&(e.visible=!0,a.visible=!1,t.pause(),o.add(e)))},!1);document.body.appendChild(O.domElement)},926:function(e){e.exports='<img class="map" src="<%= mapImage %>"/> <img class="red-dot room0" data-name="room0" src="<%= redDotImage %>"/> <img class="red-dot room1" data-name="room1" src="<%= redDotImage %>"/> <img class="red-dot room2" data-name="room2" src="<%= redDotImage %>"/> <img class="red-dot room3" data-name="room3" src="<%= redDotImage %>"/> <img class="red-dot room4" data-name="room4" src="<%= redDotImage %>"/> <img class="red-dot room5" data-name="room5" src="<%= redDotImage %>"/> <img class="red-dot room6" data-name="room6" src="<%= redDotImage %>"/> <img class="red-dot room7" data-name="room7" src="<%= redDotImage %>"/> <img class="red-dot room8" data-name="room8" src="<%= redDotImage %>"/> <img class="red-dot room9" data-name="room9" src="<%= redDotImage %>"/> <img class="red-dot room10" data-name="room10" src="<%= redDotImage %>"/> <img id="map-dir" src="<%= mapDirImage %>"/> '},376:function(e){e.exports='<img class="roam-img" src="<%= roamImage %>"/> <div class="roam-text" id="roam-text">漫游</div> '},722:function(e,o,t){e.exports=t.p+"static/images/daoyin.png"},525:function(e,o,t){e.exports=t.p+"static/images/map.png"},451:function(e){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAADhlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAAqACAAQAAAABAAAAEKADAAQAAAABAAAAEAAAAAAXnVPIAAABbElEQVQ4EZVSPU7DUAy2nSpdQSx05AQNN2hOUBgRas8AI6KVOpQZuAGqxJ6eIL1Bwwlgg4WfjlTqM/ZLX3iJ0iDekJf4+z47tj+Eylk/3kRooM/APWCOLIyYIeCCCebh+XXmS9D/WM+mF4Bw68dK78xfgk/CwfjexYsE37Npggh9BzTd8ndJezA+VY5NUK1s3p7BZCmY91ebhw46QFEMdHj0m5fhMhyO7lB7BsNLh2yWKWyeUvdZuoNuDMFxnMe0nYBiYmNOHEsr7xIrRzHl2IO4p1pChl4eEYJU/+v4HNUSIOarEiV/5j03JeGPEqdLTeRarNiboIhIYpbCGLjfqdX4wRJHtMQIC0coJuwCNbfPUS0hUSK8lXJ1z7qqXUcxzwursNV6sB3VGUmn7Yaqv62VPbFMfGskV+1fVmaYt4cj659iCzYgWSWhbcclrtwrrezEivlLsVy1tjrMGsx5RKatA7M9n129WOL28QPFw5J+M6rtIQAAAABJRU5ErkJggg=="},502:function(e,o,t){e.exports=t.p+"static/images/manyou.png"},317:function(e,o,t){e.exports=t.p+"static/images/guidepost.png"},976:function(e,o,t){e.exports=t.p+"static/images/pauseIcon.png"},471:function(e,o,t){e.exports=t.p+"static/images/playIcon.png"},367:function(e,o,t){e.exports=t.p+"static/images/poster.jpg"}},function(e){e.O(0,[736],function(){return e(e.s=291)}),e.O()}]);